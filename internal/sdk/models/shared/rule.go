// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"errors"
	"fmt"
	"github.com/zeronetworks/terraform-provider-zeronetworks/internal/sdk/internal/utils"
)

type LocalEntityInfoType string

const (
	LocalEntityInfoTypeAsset LocalEntityInfoType = "asset"
	LocalEntityInfoTypeGroup LocalEntityInfoType = "group"
)

type LocalEntityInfo struct {
	Asset *Asset `queryParam:"inline" name:"localEntityInfo"`
	Group *Group `queryParam:"inline" name:"localEntityInfo"`

	Type LocalEntityInfoType
}

func CreateLocalEntityInfoAsset(asset Asset) LocalEntityInfo {
	typ := LocalEntityInfoTypeAsset

	return LocalEntityInfo{
		Asset: &asset,
		Type:  typ,
	}
}

func CreateLocalEntityInfoGroup(group Group) LocalEntityInfo {
	typ := LocalEntityInfoTypeGroup

	return LocalEntityInfo{
		Group: &group,
		Type:  typ,
	}
}

func (u *LocalEntityInfo) UnmarshalJSON(data []byte) error {

	var asset Asset = Asset{}
	if err := utils.UnmarshalJSON(data, &asset, "", true, nil); err == nil {
		u.Asset = &asset
		u.Type = LocalEntityInfoTypeAsset
		return nil
	}

	var group Group = Group{}
	if err := utils.UnmarshalJSON(data, &group, "", true, nil); err == nil {
		u.Group = &group
		u.Type = LocalEntityInfoTypeGroup
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for LocalEntityInfo", string(data))
}

func (u LocalEntityInfo) MarshalJSON() ([]byte, error) {
	if u.Asset != nil {
		return utils.MarshalJSON(u.Asset, "", true)
	}

	if u.Group != nil {
		return utils.MarshalJSON(u.Group, "", true)
	}

	return nil, errors.New("could not marshal union type LocalEntityInfo: all fields are null")
}

type Rule struct {
	// * 1 - Allow
	// * 2 - Block
	//
	Action          *RuleAction `json:"action,omitempty"`
	AeOverridden    *bool       `json:"aeOverridden,omitempty"`
	ActivitiesCount *int        `json:"activitiesCount,omitempty"`
	// Epoch Millis
	ApprovedAt *int64      `json:"approvedAt,omitempty"`
	ApprovedBy *IDNamePair `json:"approvedBy,omitempty"`
	// Epoch Millis
	CreatedAt    *int64     `json:"createdAt,omitempty"`
	CreatedBy    *CreatedBy `json:"createdBy,omitempty"`
	ChangeTicket *string    `json:"changeTicket,omitempty"`
	Context      *int64     `json:"context,omitempty"`
	// Epoch Millis
	DeletedAt   *int64      `json:"deletedAt,omitempty"`
	DeletedBy   *IDNamePair `json:"deletedBy,omitempty"`
	Description *string     `json:"description,omitempty"`
	// * '1' - Inbound
	// * '2' - Outbound
	// * '3' - Both
	//
	Direction            *RuleDirection `json:"direction,omitempty"`
	ExcludedEntityInfos  []IDNamePair   `json:"excludedEntityInfos,omitempty"`
	ExcludedLocalIdsList []string       `json:"excludedLocalIdsList,omitempty"`
	// Epoch Millis
	ExpiresAt *int64  `json:"expiresAt,omitempty"`
	ID        *string `json:"id,omitempty"`
	// * For allow rule only.
	// * '1' - Off
	// * '2' - Null encapsulation connections
	// * '3' - Authenticated and integrity-protected connections
	// * '4' - Encrypted connections and dynamically negotiate encryption (inbound rule only)
	// * '5' - Encrypted connections
	//
	IPSecOpt                   *IPSecOpt         `json:"ipSecOpt,omitempty"`
	LocalEntityID              *string           `json:"localEntityId,omitempty"`
	LocalProcessesList         []string          `json:"localProcessesList,omitempty"`
	LocalEntityInfos           []LocalEntityInfo `json:"localEntityInfos,omitempty"`
	MultipleLocalEntityIdsList []string          `json:"multipleLocalEntityIdsList,omitempty"`
	Name                       *string           `json:"name,omitempty"`
	ParentID                   *string           `json:"parentId,omitempty"`
	ParentSwitchRuleID         *string           `json:"parentSwitchRuleId,omitempty"`
	ParentSwitchRuleType       *int              `json:"parentSwitchRuleType,omitempty"`
	ParentType                 *int              `json:"parentType,omitempty"`
	PortsList                  []PortsList       `json:"portsList,omitempty"`
	RemoteEntityIdsList        []string          `json:"remoteEntityIdsList,omitempty"`
	RemoteEntityInfos          []IDNamePair      `json:"remoteEntityInfos,omitempty"`
	// * '1' - Trivial
	// * '2' - Permissive
	// * '3' - Privileged
	// * '4' - Critical
	// * '5' - System
	// * '6' - Preventative
	// * '8' - Dangerous
	//
	Ruleclass *RuleClass `json:"ruleclass,omitempty"`
	// Mandatory object for rule review approve_with_changes / reject.
	//
	// reason: {
	//     HUMAN_TRAFFIC_COVERED_BY_MFA = 1,
	//     TIGHTEN_RULE_SCOPE = 2,
	//     MISSING_PORT_OR_PROCESS = 3,
	//     AFFECTED_ENTITIES_CONTAINED_IN_AN_EXISTING_GROUP = 4,
	//     REDUNDANT_RULE = 5,
	//     TRAFFIC_SHOULD_BE_BLOCKED = 6,
	//     OTHER = 7
	// }
	RuleReview   *RuleReviewReason `json:"ruleReview,omitempty"`
	ServicesList []string          `json:"servicesList,omitempty"`
	SrcUsersList []SrcUsersList    `json:"srcUsersList,omitempty"`
	// * '1' - Enabled
	// * '2' - Disabled
	// * '3' - Deleted By User
	// * '4' - Pending Review
	// * '5' - Pending Review Auto
	// * '6' - Rejected by User
	// * '7' - Excluded by User
	//
	State *RuleState `json:"state,omitempty"`
	// Epoch Millis
	UpdatedAt       *int64      `json:"updatedAt,omitempty"`
	UpdatedBy       *IDNamePair `json:"updatedBy,omitempty"`
	IsRejectOnLinux *bool       `json:"isRejectOnLinux,omitempty"`
}

func (r *Rule) GetAction() *RuleAction {
	if r == nil {
		return nil
	}
	return r.Action
}

func (r *Rule) GetAeOverridden() *bool {
	if r == nil {
		return nil
	}
	return r.AeOverridden
}

func (r *Rule) GetActivitiesCount() *int {
	if r == nil {
		return nil
	}
	return r.ActivitiesCount
}

func (r *Rule) GetApprovedAt() *int64 {
	if r == nil {
		return nil
	}
	return r.ApprovedAt
}

func (r *Rule) GetApprovedBy() *IDNamePair {
	if r == nil {
		return nil
	}
	return r.ApprovedBy
}

func (r *Rule) GetCreatedAt() *int64 {
	if r == nil {
		return nil
	}
	return r.CreatedAt
}

func (r *Rule) GetCreatedBy() *CreatedBy {
	if r == nil {
		return nil
	}
	return r.CreatedBy
}

func (r *Rule) GetChangeTicket() *string {
	if r == nil {
		return nil
	}
	return r.ChangeTicket
}

func (r *Rule) GetContext() *int64 {
	if r == nil {
		return nil
	}
	return r.Context
}

func (r *Rule) GetDeletedAt() *int64 {
	if r == nil {
		return nil
	}
	return r.DeletedAt
}

func (r *Rule) GetDeletedBy() *IDNamePair {
	if r == nil {
		return nil
	}
	return r.DeletedBy
}

func (r *Rule) GetDescription() *string {
	if r == nil {
		return nil
	}
	return r.Description
}

func (r *Rule) GetDirection() *RuleDirection {
	if r == nil {
		return nil
	}
	return r.Direction
}

func (r *Rule) GetExcludedEntityInfos() []IDNamePair {
	if r == nil {
		return nil
	}
	return r.ExcludedEntityInfos
}

func (r *Rule) GetExcludedLocalIdsList() []string {
	if r == nil {
		return nil
	}
	return r.ExcludedLocalIdsList
}

func (r *Rule) GetExpiresAt() *int64 {
	if r == nil {
		return nil
	}
	return r.ExpiresAt
}

func (r *Rule) GetID() *string {
	if r == nil {
		return nil
	}
	return r.ID
}

func (r *Rule) GetIPSecOpt() *IPSecOpt {
	if r == nil {
		return nil
	}
	return r.IPSecOpt
}

func (r *Rule) GetLocalEntityID() *string {
	if r == nil {
		return nil
	}
	return r.LocalEntityID
}

func (r *Rule) GetLocalProcessesList() []string {
	if r == nil {
		return nil
	}
	return r.LocalProcessesList
}

func (r *Rule) GetLocalEntityInfos() []LocalEntityInfo {
	if r == nil {
		return nil
	}
	return r.LocalEntityInfos
}

func (r *Rule) GetMultipleLocalEntityIdsList() []string {
	if r == nil {
		return nil
	}
	return r.MultipleLocalEntityIdsList
}

func (r *Rule) GetName() *string {
	if r == nil {
		return nil
	}
	return r.Name
}

func (r *Rule) GetParentID() *string {
	if r == nil {
		return nil
	}
	return r.ParentID
}

func (r *Rule) GetParentSwitchRuleID() *string {
	if r == nil {
		return nil
	}
	return r.ParentSwitchRuleID
}

func (r *Rule) GetParentSwitchRuleType() *int {
	if r == nil {
		return nil
	}
	return r.ParentSwitchRuleType
}

func (r *Rule) GetParentType() *int {
	if r == nil {
		return nil
	}
	return r.ParentType
}

func (r *Rule) GetPortsList() []PortsList {
	if r == nil {
		return nil
	}
	return r.PortsList
}

func (r *Rule) GetRemoteEntityIdsList() []string {
	if r == nil {
		return nil
	}
	return r.RemoteEntityIdsList
}

func (r *Rule) GetRemoteEntityInfos() []IDNamePair {
	if r == nil {
		return nil
	}
	return r.RemoteEntityInfos
}

func (r *Rule) GetRuleclass() *RuleClass {
	if r == nil {
		return nil
	}
	return r.Ruleclass
}

func (r *Rule) GetRuleReview() *RuleReviewReason {
	if r == nil {
		return nil
	}
	return r.RuleReview
}

func (r *Rule) GetServicesList() []string {
	if r == nil {
		return nil
	}
	return r.ServicesList
}

func (r *Rule) GetSrcUsersList() []SrcUsersList {
	if r == nil {
		return nil
	}
	return r.SrcUsersList
}

func (r *Rule) GetState() *RuleState {
	if r == nil {
		return nil
	}
	return r.State
}

func (r *Rule) GetUpdatedAt() *int64 {
	if r == nil {
		return nil
	}
	return r.UpdatedAt
}

func (r *Rule) GetUpdatedBy() *IDNamePair {
	if r == nil {
		return nil
	}
	return r.UpdatedBy
}

func (r *Rule) GetIsRejectOnLinux() *bool {
	if r == nil {
		return nil
	}
	return r.IsRejectOnLinux
}
